# 智能图像聚类工具

## 一、功能概述
本工具是一个基于Python和PyQt5开发的智能图像聚类软件，主要用于对大量图像进行聚类和排序处理。其核心功能包括：
1. **特征提取**：使用预训练的ResNet50模型提取图像特征。
2. **图像聚类**：利用Faiss库进行K - 均值聚类，自动确定最佳聚类数。
3. **文件整理**：将聚类后的图像复制到对应的聚类文件夹中，同时支持复制对应的RAW格式文件。
4. **图像排序**：使用预训练的MobileNetV4模型对每个聚类中的图像进行相似度排序。
5. **可视化**：使用t - 分布随机邻域嵌入（TSNE）对图像特征进行降维，并生成聚类可视化图。
6. **用户界面**：提供简洁易用的图形用户界面（GUI），支持文件夹拖拽、参数设置和任务取消等操作。
![程序界面截图](images/01.png)

## 二、使用方法
1. **选择输入文件夹**：点击“选择”按钮或直接将文件夹拖拽到输入框，选择包含待处理图像的文件夹。
2. **选择输出文件夹**：点击“选择”按钮或直接将文件夹拖拽到输出框，选择用于保存聚类结果的文件夹。
3. **设置参数**：
    - **最大聚类数**：设置聚类的最大数量。
    - **迭代次数**：设置K - 均值聚类的迭代次数。
    - **启用智能排序**：勾选该选项可对每个聚类中的图像进行相似度排序。
    - **处理完成后删除输入文件夹**：勾选该选项，处理完成后将删除输入文件夹（此操作不可逆）。
4. **开始聚类**：点击“开始聚类”按钮，开始处理图像。处理过程中可点击“取消”按钮停止任务。
5. **查看结果**：处理完成后，点击“打开输出文件夹”按钮查看聚类结果和可视化图。

## 三、注意事项
- 请确保输入文件夹中包含有效的图像文件（支持 `.jpg`, `.jpeg`, `.png`, `.bmp` 等格式）。
- 请确保已下载并正确配置预训练模型文件 `weights/MobileNetV4.bin`。
- 处理大量图像可能需要较长时间，请耐心等待。
- 若处理过程中出现错误，可查看 `image_clustering.log` 文件获取详细错误信息。